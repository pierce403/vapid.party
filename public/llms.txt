vapid.party â€” Web Push Relay API (VAPID)

Base URL:
- https://vapid.party

OpenAPI:
- /openapi.yaml

Auth:
- App management endpoints use `Authorization: Bearer <token>` (wallet auth)
- Push endpoints use `X-API-Key: <vp_...>` (per-app API key)

Response shape:
- Success: `{ "success": true, "data": ... }`
- Error: `{ "success": false, "error": "...", "code": "...", "details": ...? }`
- Validation errors use HTTP 422 and include `details.issues[]` with:
  - `fieldPath` (dot/bracket path), `message`, and best-effort `value`

Push workflow (typical):
1) Create an app (wallet auth)
   - POST /api/register-app
   - Response includes: `apiKey` and `vapidPublicKey`

2) Get VAPID public key (API key auth)
   - GET /api/vapid/public-key
   - Use `data.publicKey` as `applicationServerKey` for `PushManager.subscribe`

3) Create/update a subscription (API key auth)
   - POST /api/subscribe
   - Body:
     - `endpoint` (absolute URL)
     - `keys.p256dh` and `keys.auth` (base64url or base64; server normalizes to base64url)
     - Optional tags:
       - `userId`: arbitrary string for user-scoped targeting
       - `channelId`: arbitrary string for channel-scoped targeting

4) Send notifications (API key auth)
   - POST /api/send
   - Targeting rules:
     - If `subscriptionIds` is present, only those subscriptions are targeted (and `userId`/`channelId` are ignored).
     - Otherwise, `userId` and/or `channelId` filter recipients.
     - If no targeting fields are present, sends to all subscriptions for the app.
   - `payload.url`, `payload.icon`, `payload.badge`, `payload.image` can be absolute URLs or `/paths`.

Example: send to a channel
POST /api/send
Headers:
  X-API-Key: vp_...
Body:
{
  "payload": { "title": "Announcement", "body": "Hello!", "url": "/announcements" },
  "channelId": "announcements"
}
